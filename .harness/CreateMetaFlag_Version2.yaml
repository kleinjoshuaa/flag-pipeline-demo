template:
  name: CreateMetaFlag
  type: Step
  spec:
    type: Http
    spec:
      url: https://api.split.io/internal/api/v2/splits/ws/<+pipeline.variables.Workspace>/trafficTypes/<+pipeline.variables.trafficType>
      method: POST
      headers:
        - key: Content-Type
          value: application/json
        - key: Authorization
          value: Bearer <+secrets.getValue("splitApiKey")>
      inputVariables: []
      outputVariables:
        - name: flagName
          value: <+json.select("id", httpResponseBody)>
          type: String
      requestBody: "{\"name\": \"<+pipeline.variables.flagName>\",\"description\": \"<+pipeline.variables.flagName>\"}"
      assertion: <+httpResponseCode>==200
    timeout: 10s
  versionLabel: Version2
  identifier: CreateMetaFlag
