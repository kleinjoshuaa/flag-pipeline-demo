template:
  name: CreateMetaFlag
  type: Step
  spec:
    type: Http
    spec:
      url: https://api.split.io/internal/api/v2/splits/ws/<+pipeline.variables.Workspace>/trafficTypes/<+pipeline.variables.trafficType>
      method: POST
      headers: []
      inputVariables:
        - name: Content-Type
          value: application/json
          type: String
        - name: Authorization
          value: Bearer <+secrets.getValue("splitApiKey")>
          type: String
      outputVariables:
        - name: flagId
          value: <+json.select("id", httpResponseBody)>
          type: String
      requestBody: |-
        {
            "name": "<+pipeline.variables.flagName>",
            "description": "<+pipeline.variables.flagName>",
        }
    timeout: 10s
  identifier: CreateMetaFlag
  versionLabel: Version1
